sudo: no
language: python
python:
  - '3.7'
before_script:
  # install requirements:
  - pip install -r requirements.txt
  - psql -c 'create database jasmin_web_db;' -U postgres
  - psql -c 'create role travis superuser login createdb;' -U postgres
test:
  adapter: postgresql
  database: jasmin_web_db
  encoding: unicode
  pool: 5
  username: postgres
  password:
  min_messages: warning
before_install:
  - sudo apt-get install -y libpq-dev postgresql-client postgresql-client-common python3-psycopg2 postgresql postgresql-contrib
  - virtualenv -p python3 env
  - source env/bin/activate
  - cp -rf Sample.env .env
services:
  - postgresql
  - redis-server
addons:
  postgresql: "12"
  apt:
    packages:
      - python-setuptools
      - python3-dev
      - python3-pip
      - git
      - virtualenv
env:
  - DJANGO_SETTINGS_MODULE=config.settings.pro
script:  
  - ./load_data.sh --init