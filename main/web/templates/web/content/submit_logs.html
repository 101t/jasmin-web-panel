{% extends "web/base.html" %}
{% load static i18n %}
{% block title %}{% trans "Submit Logs" %}{% endblock title %}
{% block extracss %}{% endblock extracss %}
{% block content %}
<h1 class="h3 mb-2 text-gray-800">{% trans "Submit Logs" %}</h1>
<div class="card shadow mb-4">
    <div class="card-header py-3">
        <form method="get" class="form-inline" id="filter-form">
            <div class="form-group mr-2 mb-2">
                <input type="text" name="search" class="form-control" placeholder="{% trans 'Search...' %}" value="{{ search_query }}">
            </div>
            <div class="form-group mr-2 mb-2">
                <select name="status_filter" class="form-control">
                    <option value="">{% trans "All Status" %}</option>
                    <option value="success" {% if status_filter == 'success' %}selected{% endif %}>{% trans "Success" %}</option>
                    <option value="fail" {% if status_filter == 'fail' %}selected{% endif %}>{% trans "Failed" %}</option>
                    <option value="unknown" {% if status_filter == 'unknown' %}selected{% endif %}>{% trans "Unknown" %}</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary btn-sm mr-2 mb-2"><i class="fas fa-search"></i> {% trans "Filter" %}</button>
            <a href="{% url 'web:submit_logs_view' %}" class="btn btn-secondary btn-sm mb-2"><i class="fas fa-redo"></i> {% trans "Reset" %}</a>
        </form>
    </div>
    <div class="card-body">
        <div class="status-counts mb-3">
            <span class="badge badge-default">{% trans "Total" %}: {{ stats.total_count }}</span>
            <span class="badge badge-success">{% trans "Success" %}: {{ stats.success_count }}</span>
            <span class="badge badge-danger">{% trans "Failed" %}: {{ stats.fail_count }}</span>
            <span class="badge badge-secondary">{% trans "Unknown" %}: {{ stats.unknown_count }}</span>
        </div>
        <div class="table-responsive">
            <table class="table table-hover table-striped table-bordered table-sm">
                <thead>
                    <tr>
                       <th>{% trans "Message ID" %}</th>
                        <th>{% trans "Src. Address" %}</th>
                        <th>{% trans "Dst. Address" %}</th>
                        <th>{% trans "Short message" %}</th>
                        <th>{% trans "Rate" %}</th>
                        <th>{% trans "PDU Count" %}</th>
                        <th>{% trans "UID" %}</th>
                        <th>{% trans "Trials" %}</th>
                        <th>{% trans "Created At" %}</th>
                        <th>{% trans "Status At" %}</th>
                        <th class="text-center">{% trans "Status" %}</th>
                        <!--<th class="text-center">{% trans "Option" %}</th>-->
                    </tr>
                </thead>
                <tbody id="collection_list">
                {% for record in submit_logs %}
                    <tr>
                        <td>{{ record.msgid }}</td>
                        <td>{{ record.decoded_source_addr }}</td>
                        <td>{{ record.decoded_destination_addr }}</td>
                        <td>{{ record.decoded_short_message }}</td>
                        <td>{{ record.rate }}</td>
                        <td>{{ record.pdu_count }}</td>
                        <td>{{ record.uid }}</td>
                        <td>{{ record.trials }}</td>
                        <td>{{ record.created_at }}</td>
                        <td>{{ record.status_at }}</td>
                        <td class="text-center">
                            {% if record.status == 'ESME_ROK' or record.status == 'ESME_RINVNUMDESTS' %}
                                <span class="badge badge-success">{{ record.status }}</span>
                            {% elif record.status == 'ESME_RDELIVERYFAILURE' %}
                                <span class="badge badge-danger">{{ record.status }}</span>
                            {% else %}
                                <span class="badge badge-secondary">{{ record.status }}</span>
                            {% endif %}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="11" class="text-center"><i class="fas fa-clipboard-list text-metal" style="font-size:5rem;"></i><br>{% trans "No Submit Logs" %}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            {% include "web/includes/paginate.html" with page_obj=submit_logs %}
        </div>
    </div>
</div>
{% csrf_token %}
{% endblock content %}
{% block extrajs %}
<script>
var main_trans = {};
</script>
<script src="{% static 'web/content/submit_logs.js' %}"></script>
{% endblock extrajs %}